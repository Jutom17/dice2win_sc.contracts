const Web3 = require('web3');

var web3 = new Web3('http://54.250.21.165:8545');  //rinkeby
//const web3 = new Web3('ws://54.249.21.74:8546'); //mainnet
//const web3 = new Web3('http://54.249.21.74:8545'); //mainnet

const Tx = require('ethereumjs-tx')

const paymentABI = [ { "constant": true, "inputs": [], "name": "settle_window_min", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "channelCounter", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "", "type": "bytes32" } ], "name": "channels", "outputs": [ { "name": "state", "type": "uint8" }, { "name": "settleBlock", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "", "type": "bytes32" } ], "name": "participantsHash_to_channelCounter", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "settle_window_max", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "game", "outputs": [ { "name": "", "type": "address" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "", "type": "bytes32" }, { "name": "", "type": "address" } ], "name": "lockIdentifier_to_lockedAmount", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "inputs": [ { "name": "_game", "type": "address" }, { "name": "_settle_window_min", "type": "uint256" }, { "name": "_settle_window_max", "type": "uint256" } ], "payable": false, "stateMutability": "nonpayable", "type": "constructor" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "participant1", "type": "address" }, { "indexed": true, "name": "participant2", "type": "address" }, { "indexed": false, "name": "channelIdentifier", "type": "bytes32" }, { "indexed": false, "name": "settle_timeout", "type": "uint256" }, { "indexed": false, "name": "amount", "type": "uint256" } ], "name": "ChannelOpened", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "channel_identifier", "type": "bytes32" }, { "indexed": true, "name": "participant", "type": "address" }, { "indexed": false, "name": "total_deposit", "type": "uint256" } ], "name": "ChannelNewDeposit", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "channelIdentifier", "type": "bytes32" }, { "indexed": false, "name": "participant1_balance", "type": "uint256" }, { "indexed": false, "name": "participant2_balance", "type": "uint256" } ], "name": "CooperativeSettled", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "channel_identifier", "type": "bytes32" }, { "indexed": true, "name": "closing", "type": "address" }, { "indexed": false, "name": "balanceHash", "type": "bytes32" } ], "name": "ChannelClosed", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "channel_identifier", "type": "bytes32" }, { "indexed": true, "name": "nonclosing", "type": "address" }, { "indexed": false, "name": "balanceHash", "type": "bytes32" } ], "name": "NonclosingUpdateBalanceProof", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "channelIdentifier", "type": "bytes32" }, { "indexed": true, "name": "participant1", "type": "address" }, { "indexed": true, "name": "participant2", "type": "address" }, { "indexed": false, "name": "lockedIdentifier", "type": "bytes32" }, { "indexed": false, "name": "transferToParticipant1Amount", "type": "uint256" }, { "indexed": false, "name": "transferToParticipant2Amount", "type": "uint256" } ], "name": "ChannelSettled", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "channelIdentifier", "type": "bytes32" }, { "indexed": true, "name": "beneficiary", "type": "address" }, { "indexed": false, "name": "amount", "type": "uint256" } ], "name": "ChannelLockedSent", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "channelIdentifier", "type": "bytes32" }, { "indexed": true, "name": "beneficiary", "type": "address" }, { "indexed": false, "name": "amount", "type": "uint256" } ], "name": "ChannelLockedReturn", "type": "event" }, { "constant": false, "inputs": [ { "name": "participant", "type": "address" }, { "name": "partner", "type": "address" }, { "name": "settle_window", "type": "uint256" } ], "name": "openChannel", "outputs": [], "payable": true, "stateMutability": "payable", "type": "function" }, { "constant": false, "inputs": [ { "name": "participant", "type": "address" }, { "name": "partner", "type": "address" } ], "name": "setTotalDeposit", "outputs": [], "payable": true, "stateMutability": "payable", "type": "function" }, { "constant": false, "inputs": [ { "name": "participant1_address", "type": "address" }, { "name": "participant1_balance", "type": "uint256" }, { "name": "participant2_address", "type": "address" }, { "name": "participant2_balance", "type": "uint256" }, { "name": "participant1_signature", "type": "bytes" }, { "name": "participant2_signature", "type": "bytes" } ], "name": "cooperativeSettle", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": false, "inputs": [ { "name": "partner", "type": "address" }, { "name": "balanceHash", "type": "bytes32" }, { "name": "nonce", "type": "uint256" }, { "name": "signature", "type": "bytes" } ], "name": "closeChannel", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": false, "inputs": [ { "name": "closing", "type": "address" }, { "name": "balanceHash", "type": "bytes32" }, { "name": "nonce", "type": "uint256" }, { "name": "signature", "type": "bytes" } ], "name": "nonclosingUpdateBalanceProof", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": false, "inputs": [ { "name": "participant1", "type": "address" }, { "name": "participant1_transferred_amount", "type": "uint256" }, { "name": "participant1_locked_amount", "type": "uint256" }, { "name": "participant1_lock_id", "type": "uint256" }, { "name": "participant2", "type": "address" }, { "name": "participant2_transferred_amount", "type": "uint256" }, { "name": "participant2_locked_amount", "type": "uint256" }, { "name": "participant2_lock_id", "type": "uint256" } ], "name": "settleChannel", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": false, "inputs": [ { "name": "participant1", "type": "address" }, { "name": "participant2", "type": "address" }, { "name": "lockIdentifier", "type": "bytes32" } ], "name": "unlock", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [ { "name": "participant", "type": "address" }, { "name": "partner", "type": "address" } ], "name": "getChannelIdentifier", "outputs": [ { "name": "", "type": "bytes32" } ], "payable": false, "stateMutability": "view", "type": "function" } ];

const diceABI = [ { "constant": true, "inputs": [], "name": "revealWindow", "outputs": [ { "name": "", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "", "type": "bytes32" } ], "name": "roundIdentifier_to_diceInfo", "outputs": [ { "name": "positive", "type": "address" }, { "name": "negative", "type": "address" }, { "name": "betMask", "type": "uint256" }, { "name": "modulo", "type": "uint256" }, { "name": "initiatorHashR", "type": "bytes32" }, { "name": "acceptorR", "type": "bytes32" }, { "name": "state", "type": "uint8" }, { "name": "lastRevealBlock", "type": "uint256" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "inputs": [ { "name": "_revealWindow", "type": "uint256" } ], "payable": false, "stateMutability": "nonpayable", "type": "constructor" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "initiator", "type": "address" }, { "indexed": true, "name": "acceptor", "type": "address" }, { "indexed": false, "name": "roundIdentifier", "type": "bytes32" }, { "indexed": false, "name": "winner", "type": "address" } ], "name": "InitiatorSettled", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "initiator", "type": "address" }, { "indexed": true, "name": "acceptor", "type": "address" }, { "indexed": false, "name": "roundIdentifier", "type": "bytes32" }, { "indexed": false, "name": "lastRevealBlock", "type": "uint256" } ], "name": "AcceptorSettled", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "initiator", "type": "address" }, { "indexed": true, "name": "acceptor", "type": "address" }, { "indexed": false, "name": "roundIdentifier", "type": "bytes32" }, { "indexed": false, "name": "winner", "type": "address" } ], "name": "InitiatorRevealed", "type": "event" }, { "constant": false, "inputs": [ { "name": "channelIdentifier", "type": "bytes32" }, { "name": "round", "type": "uint256" }, { "name": "betMask", "type": "uint256" }, { "name": "modulo", "type": "uint256" }, { "name": "positive", "type": "address" }, { "name": "negative", "type": "address" }, { "name": "initiatorHashR", "type": "bytes32" }, { "name": "initiatorSignature", "type": "bytes" }, { "name": "acceptorR", "type": "bytes32" }, { "name": "acceptorSignature", "type": "bytes" }, { "name": "initiatorR", "type": "bytes32" } ], "name": "initiatorSettle", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": false, "inputs": [ { "name": "channelIdentifier", "type": "bytes32" }, { "name": "round", "type": "uint256" }, { "name": "betMask", "type": "uint256" }, { "name": "modulo", "type": "uint256" }, { "name": "positive", "type": "address" }, { "name": "negative", "type": "address" }, { "name": "initiatorHashR", "type": "bytes32" }, { "name": "initiatorSignature", "type": "bytes" }, { "name": "acceptorR", "type": "bytes32" } ], "name": "acceptorSettle", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": false, "inputs": [ { "name": "channelIdentifier", "type": "bytes32" }, { "name": "round", "type": "uint256" }, { "name": "initiatorR", "type": "bytes32" } ], "name": "initiatorReveal", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [ { "name": "roundIdentifier", "type": "bytes32" } ], "name": "getResult", "outputs": [ { "name": "", "type": "address" } ], "payable": false, "stateMutability": "view", "type": "function" } ];

const paymentData = "0x608060405234801561001057600080fd5b5060405160608061376e833981018060405281019080805190602001909291908051906020019092919080519060200190929190505050826000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555081600581905550806006819055505050506136c7806100a76000396000f3006080604052600436106100db576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680630a798f24146100e05780630ab943e11461014057806318444694146101df5780635a1047461461020a57806377c5f23c146102355780637a7ebd7b146102a657806384a769b2146102f85780638568536a146103995780638a6e80181461049c578063938bcd67146104e15780639e45b47814610560578063b4778bea1461058b578063c3fe3e28146105e1578063c6bf4ec514610638578063ddfb48cb1461069d575b600080fd5b61013e600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff1690602001909291908035906020019092919050505061073e565b005b34801561014c57600080fd5b506101dd600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001909291908035906020019092919080359060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001909291908035906020019092919080359060200190929190505050610a68565b005b3480156101eb57600080fd5b506101f4611087565b6040518082815260200191505060405180910390f35b34801561021657600080fd5b5061021f61108d565b6040518082815260200191505060405180910390f35b34801561024157600080fd5b506102a4600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff1690602001909291908035600019169060200190929190505050611093565b005b3480156102b257600080fd5b506102d5600480360381019080803560001916906020019092919050505061171a565b604051808360ff1660ff1681526020018281526020019250505060405180910390f35b34801561030457600080fd5b50610397600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803560001916906020019092919080359060200190929190803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919291929050505061174b565b005b3480156103a557600080fd5b5061049a600480360381019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290505050611a54565b005b3480156104a857600080fd5b506104cb600480360381019080803560001916906020019092919050505061204e565b6040518082815260200191505060405180910390f35b3480156104ed57600080fd5b50610542600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050612066565b60405180826000191660001916815260200191505060405180910390f35b34801561056c57600080fd5b5061057561221a565b6040518082815260200191505060405180910390f35b6105df600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050612220565b005b3480156105ed57600080fd5b506105f66123b4565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561064457600080fd5b506106876004803603810190808035600019169060200190929190803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506123d9565b6040518082815260200191505060405180910390f35b3480156106a957600080fd5b5061073c600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803560001916906020019092919080359060200190929190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091929192905050506123fe565b005b600080600083600654811115801561075857506005548110155b15156107cc576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260158152602001807f696e76616c696420736574746c652077696e646f77000000000000000000000081525060200191505060405180910390fd5b6107d68787612824565b935060006002600086600019166000191681526020019081526020016000205414151561086b576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260168152602001807f6368616e6e656c20616c7265616479206578697374730000000000000000000081525060200191505060405180910390fd5b6000341115156108e3576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260208152602001807f73686f756c64206465706f736974207768656e206f70656e206368616e6e656c81525060200191505060405180910390fd5b600180600082825401925050819055506001546002600086600019166000191681526020019081526020016000208190555061091f8787612066565b9250600160036000856000191660001916815260200190815260200160002060000160006101000a81548160ff021916908360ff160217905550846003600085600019166000191681526020019081526020016000206002018190555060036000846000191660001916815260200190815260200160002060010160008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002091503482600001819055508573ffffffffffffffffffffffffffffffffffffffff168773ffffffffffffffffffffffffffffffffffffffff167ff43f324498a3f4dd1b8ffef6d6af08dc193c1707f7f669feacf8ff4e50fbdd3a858834604051808460001916600019168152602001838152602001828152602001935050505060405180910390a350505050505050565b6000806000610a778b88612066565b9250600360008460001916600019168152602001908152602001600020915060028260000160009054906101000a900460ff1660ff16141515610b22576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601d8152602001807f6368616e6e656c2073746174652073686f6c6420626520636c6f73656400000081525060200191505060405180910390fd5b438260020154101515610b9d576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260208152602001807f736574746c656d656e742077696e646f772073686f756c64206265206f76657281525060200191505060405180910390fd5b610be98260010160008d73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208b8b8b612b53565b610c358260010160008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020878787612b53565b610c44838c8b8b8b8a8a612cb0565b809750819b50829350505050610cde8260010160008d73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208b8b8560010160008c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208a8a6130e2565b809750819b5050508160010160008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600001548260010160008d73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000015401868b878c01010111151515610e14576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260278152602001807f63616e6e6f74207769746864726177206d6f72652076616c7565207468616e2081526020017f6465706f7369740000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b8160010160008c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000808201600090556001820160006101000a81549060ff02191690556002820160009055600382016000905550508160010160008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000808201600090556001820160006101000a81549060ff0219169055600282016000905560038201600090555050600360008460001916600019168152602001908152602001600020600080820160006101000a81549060ff02191690556002820160009055505060026000610f3c8d8a612824565b600019166000191681526020019081526020016000206000905560008a1115610fa7578a73ffffffffffffffffffffffffffffffffffffffff166108fc8b9081150290604051600060405180830381858888f19350505050158015610fa5573d6000803e3d6000fd5b505b6000861115610ff8578673ffffffffffffffffffffffffffffffffffffffff166108fc879081150290604051600060405180830381858888f19350505050158015610ff6573d6000803e3d6000fd5b505b8673ffffffffffffffffffffffffffffffffffffffff168b73ffffffffffffffffffffffffffffffffffffffff1684600019167f35cfe29560dd5d435f75b2510c0c33105026bcc8f028eba06edb142ebd1dfef7848e8b604051808460001916600019168152602001838152602001828152602001935050505060405180910390a45050505050505050505050565b60055481565b60015481565b600080600060046000856000191660001916815260200190815260200160002060008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054925060046000856000191660001916815260200190815260200160002060008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054915060046000856000191660001916815260200190815260200160002060008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000905560046000856000191660001916815260200190815260200160002060008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600090556000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663add4c784856040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808260001916600019168152602001915050602060405180830381600087803b15801561129e57600080fd5b505af11580156112b2573d6000803e3d6000fd5b505050506040513d60208110156112c857600080fd5b8101908080519060200190929190505050905060008173ffffffffffffffffffffffffffffffffffffffff16141561144757600083111561139e578573ffffffffffffffffffffffffffffffffffffffff166108fc849081150290604051600060405180830381858888f19350505050158015611349573d6000803e3d6000fd5b508573ffffffffffffffffffffffffffffffffffffffff1684600019167f06fcb8f03d7121545713132681b1bf54af1ff9fcab01f34b23a6745f5ddbbce5856040518082815260200191505060405180910390a35b6000821115611442578473ffffffffffffffffffffffffffffffffffffffff166108fc839081150290604051600060405180830381858888f193505050501580156113ed573d6000803e3d6000fd5b508473ffffffffffffffffffffffffffffffffffffffff1684600019167f06fcb8f03d7121545713132681b1bf54af1ff9fcab01f34b23a6745f5ddbbce5846040518082815260200191505060405180910390a35b611712565b8573ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614156115c857600082111561151f578573ffffffffffffffffffffffffffffffffffffffff166108fc839081150290604051600060405180830381858888f193505050501580156114ca573d6000803e3d6000fd5b508573ffffffffffffffffffffffffffffffffffffffff1684600019167f088f29dc1537a391127b5577fa9923ab8a3738bf3f4160d5c0ca098acec24a3e846040518082815260200191505060405180910390a35b60008311156115c3578573ffffffffffffffffffffffffffffffffffffffff166108fc849081150290604051600060405180830381858888f1935050505015801561156e573d6000803e3d6000fd5b508573ffffffffffffffffffffffffffffffffffffffff1684600019167f06fcb8f03d7121545713132681b1bf54af1ff9fcab01f34b23a6745f5ddbbce5856040518082815260200191505060405180910390a35b611711565b600083111561166c578473ffffffffffffffffffffffffffffffffffffffff166108fc849081150290604051600060405180830381858888f19350505050158015611617573d6000803e3d6000fd5b508473ffffffffffffffffffffffffffffffffffffffff1684600019167f088f29dc1537a391127b5577fa9923ab8a3738bf3f4160d5c0ca098acec24a3e856040518082815260200191505060405180910390a35b6000821115611710578473ffffffffffffffffffffffffffffffffffffffff166108fc839081150290604051600060405180830381858888f193505050501580156116bb573d6000803e3d6000fd5b508473ffffffffffffffffffffffffffffffffffffffff1684600019167f06fcb8f03d7121545713132681b1bf54af1ff9fcab01f34b23a6745f5ddbbce5846040518082815260200191505060405180910390a35b5b5b505050505050565b60036020528060005260406000206000915090508060000160009054906101000a900460ff16908060020154905082565b6000806000803388600061175f8383612066565b9050600160036000836000191660001916815260200190815260200160002060000160009054906101000a900460ff1660ff16141515611807576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260168152602001807f6368616e6e656c2073686f756c64206265206f70656e0000000000000000000081525060200191505060405180910390fd5b611811338c612066565b965060036000886000191660001916815260200190815260200160002095508560010160008c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000209450600089111561195f57611888878b8b8b6131a1565b93508a73ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff16141515611953576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260298152602001807f62616c616e63652070726f6f662073686f756c64206265207369676e6564206281526020017f7920706172746e6572000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b61195e858b8b6132a0565b5b60028660000160006101000a81548160ff021916908360ff16021790555060018660010160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160006101000a81548160ff0219169083151502179055504386600201600082825401925050819055503373ffffffffffffffffffffffffffffffffffffffff1687600019167fc385db978aebc30a2ab47905160e860a190999aab78e9c8d040ca5911f83eede8c60405180826000191660001916815260200191505060405180910390a35050505050505050505050565b60008060008089886000611a688383612066565b9050600160036000836000191660001916815260200190815260200160002060000160009054906101000a900460ff1660ff16141515611b10576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260168152602001807f6368616e6e656c2073686f756c64206265206f70656e0000000000000000000081525060200191505060405180910390fd5b611b1a8d8c612066565b9650611b2a878e8e8e8e8e613336565b95508c73ffffffffffffffffffffffffffffffffffffffff168673ffffffffffffffffffffffffffffffffffffffff16141515611bf5576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602a8152602001807f7369676e61747572652073686f756c64206265207369676e656420627920706181526020017f727469636970616e74310000000000000000000000000000000000000000000081525060400191505060405180910390fd5b611c03878e8e8e8e8d613336565b95508a73ffffffffffffffffffffffffffffffffffffffff168673ffffffffffffffffffffffffffffffffffffffff16141515611cce576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602a8152602001807f7369676e61747572652073686f756c64206265207369676e656420627920706181526020017f727469636970616e74320000000000000000000000000000000000000000000081525060400191505060405180910390fd5b60036000886000191660001916815260200190815260200160002094508460010160008c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600001548560010160008f73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000154019350898c0184141515611e17576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260388152602001807f7468652073756d206f662062616c616e6365732073686f756c6420626520657181526020017f75616c20746f2074686520746f74616c206465706f736974000000000000000081525060400191505060405180910390fd5b8460010160008e73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000808201600090556001820160006101000a81549060ff02191690556002820160009055600382016000905550508460010160008c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000808201600090556001820160006101000a81549060ff0219169055600282016000905560038201600090555050600360008860001916600019168152602001908152602001600020600080820160006101000a81549060ff02191690556002820160009055505060026000611f3f8f8e612824565b600019166000191681526020019081526020016000206000905560008c1115611faa578c73ffffffffffffffffffffffffffffffffffffffff166108fc8d9081150290604051600060405180830381858888f19350505050158015611fa8573d6000803e3d6000fd5b505b60008a1115611ffb578a73ffffffffffffffffffffffffffffffffffffffff166108fc8b9081150290604051600060405180830381858888f19350505050158015611ff9573d6000803e3d6000fd5b505b86600019167f4c4399a084cb97d6d0f51a5481485cccd0eb35cf21aec6cf5140408b1b3d1bd88d8c604051808381526020018281526020019250505060405180910390a250505050505050505050505050565b60026020528060005260406000206000915090505481565b6000806000808573ffffffffffffffffffffffffffffffffffffffff16141580156120a8575060008473ffffffffffffffffffffffffffffffffffffffff1614155b80156120e057508373ffffffffffffffffffffffffffffffffffffffff168573ffffffffffffffffffffffffffffffffffffffff1614155b1515612154576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600d8152602001807f696e76616c696420696e7075740000000000000000000000000000000000000081525060200191505060405180910390fd5b61215e8585612824565b91506002600083600019166000191681526020019081526020016000205490508181604051602001808360001916600019168152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b6020831015156121e357805182526020820191506020810190506020830392506121be565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405180910390209250505092915050565b60065481565b600080838360006122318383612066565b9050600160036000836000191660001916815260200190815260200160002060000160009054906101000a900460ff1660ff161415156122d9576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260168152602001807f6368616e6e656c2073686f756c64206265206f70656e0000000000000000000081525060200191505060405180910390fd5b6122e38787612066565b945060036000866000191660001916815260200190815260200160002060010160008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002093503484600001600082825401925050819055508673ffffffffffffffffffffffffffffffffffffffff1685600019167f0346e981e2bfa2366dc2307a8f1fa24779830a01121b1275fe565c6b98bb4d3486600001546040518082815260200191505060405180910390a350505050505050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6004602052816000526040600020602052806000526040600020600091509150505481565b600080600080873360006124128383612066565b9050600260036000836000191660001916815260200190815260200160002060000160009054906101000a900460ff1660ff161415156124ba576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260188152602001807f6368616e6e656c2073686f756c6420626520636c6f736564000000000000000081525060200191505060405180910390fd5b60006001028a60001916141580156124d25750600089115b1515612546576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260158152602001807f696e76616c69642062616c616e63652070726f6f66000000000000000000000081525060200191505060405180910390fd5b612550338c612066565b965060036000886000191660001916815260200190815260200160002095508560010160008c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002094508460010160009054906101000a900460ff161515612638576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260188152602001807f706172746e65722073686f756c6420626520636c6f736572000000000000000081525060200191505060405180910390fd5b856002015443111515156126da576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260268152602001807f6368616e6e656c2073686f756c6420626520696e20736574746c656d656e742081526020017f77696e646f77000000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b6126e6878b8b8b6131a1565b93508a73ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff161415156127b1576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260258152602001807f7369676e61747572652073686f756c64206265207369676e656420627920636c81526020017f6f73696e6700000000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b6127bc858b8b6132a0565b3373ffffffffffffffffffffffffffffffffffffffff1687600019167f9402d324e62839355b4df4992553dcdef3d9451e87e9591f51a776388c04e4ca8c60405180826000191660001916815260200191505060405180910390a35050505050505050505050565b6000808373ffffffffffffffffffffffffffffffffffffffff1614158015612863575060008273ffffffffffffffffffffffffffffffffffffffff1614155b801561289b57508173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1614155b151561290f576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600d8152602001807f696e76616c696420696e7075740000000000000000000000000000000000000081525060200191505060405180910390fd5b8173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff161015612a4a578282604051602001808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c010000000000000000000000000281526014018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c01000000000000000000000000028152601401925050506040516020818303038152906040526040518082805190602001908083835b602083101515612a1657805182526020820191506020810190506020830392506129f1565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405180910390209050612b4d565b8183604051602001808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c010000000000000000000000000281526014018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c01000000000000000000000000028152601401925050506040516020818303038152906040526040518082805190602001908083835b602083101515612b1d5780518252602082019150602081019050602083039250612af8565b6001836020036101000a038019825116818451168082178552505050505050905001915050604051809103902090505b92915050565b600080600102856002015460001916148015612b6f5750600084145b8015612b7b5750600083145b8015612b875750600082145b15612b9157612ca9565b8383836040516020018084815260200183815260200182815260200193505050506040516020818303038152906040526040518082805190602001908083835b602083101515612bf65780518252602082019150602081019050602083039250612bd1565b6001836020036101000a038019825116818451168082178552505050505050905001915050604051809103902090508460020154600019168160001916141515612ca8576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601e8152602001807f62616c616e636520686173682073686f756c6420626520636f7272656374000081525060200191505060405180910390fd5b5b5050505050565b600080600080600088148015612cc65750600085145b15612cdf576000600102935060009250600091506130d4565b84881415612d86578a88604051602001808360001916600019168152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b602083101515612d4c5780518252602082019150602081019050602083039250612d27565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405180910390209350889250859150612ecb565b84881015612e2e578a85604051602001808360001916600019168152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b602083101515612df35780518252602082019150602081019050602083039250612dce565b6001836020036101000a0380198251168184511680821785525050505050509050019150506040518091039020935060009250859150612eca565b8a88604051602001808360001916600019168152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b602083101515612e935780518252602082019150602081019050602083039250612e6e565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405180910390209350600091508892505b5b600360008c6000191660001916815260200190815260200160002090508060010160008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600001548160010160008c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000015401612f7d84846134b5565b11151515613019576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260298152602001807f63616e6e6f74206c6f636b206d6f72652076616c7565207468616e20746f746181526020017f6c206465706f736974000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b8260046000866000191660001916815260200190815260200160002060008c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055508160046000866000191660001916815260200190815260200160002060008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055505b509750975097945050505050565b6000806000806131046130f58a8a6134b5565b6130ff88886134b5565b613546565b809250819350505088811415613156578187600001541161312957866000015461312b565b815b915061313d828b600001540186613569565b935061314f8288600001540389613569565b9250613194565b818a600001541161316b57896000015461316d565b815b915061317f828b600001540386613569565b93506131918288600001540189613569565b92505b5050965096945050505050565b60008030868686604051602001808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c01000000000000000000000000028152601401846000191660001916815260200183600019166000191681526020018281526020019450505050506040516020818303038152906040526040518082805190602001908083835b60208310151561325c5780518252602082019150602081019050602083039250613237565b6001836020036101000a038019825116818451168082178552505050505050905001915050604051809103902090506132958184613585565b915050949350505050565b82600301548111151561331b576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260198152602001807f6e6f6e63652073686f756c64206265206d6f6e6f746f6e69630000000000000081525060200191505060405180910390fd5b81836002018160001916905550808360030181905550505050565b600080308888888888604051602001808773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c0100000000000000000000000002815260140186600019166000191681526020018573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c010000000000000000000000000281526014018481526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c0100000000000000000000000002815260140182815260200196505050505050506040516020818303038152906040526040518082805190602001908083835b60208310151561346f578051825260208201915060208101905060208303925061344a565b6001836020036101000a038019825116818451168082178552505050505050905001915050604051809103902090506134a88184613585565b9150509695505050505050565b600081830190508281101580156134cc5750818110155b1515613540576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600a8152602001807f756e73616665206164640000000000000000000000000000000000000000000081525060200191505060405180910390fd5b92915050565b600080828411613559578383038461355e565b828403835b915091509250929050565b600081831161357957600061357d565b8183035b905092915050565b6000806000806041855114151561359b57600080fd5b6020850151925060408501519150606085015160001a9050601b8160ff1610156135c657601b810190505b601b8160ff1614806135db5750601c8160ff16145b15156135e657600080fd5b600186828585604051600081526020016040526040518085600019166000191681526020018460ff1660ff1681526020018360001916600019168152602001826000191660001916815260200194505050505060206040516020810390808403906000865af115801561365d573d6000803e3d6000fd5b50505060206040510351935060008473ffffffffffffffffffffffffffffffffffffffff161415151561368f57600080fd5b839350505050929150505600a165627a7a72305820d2652df2ac893a81563854bb0ac750b7c8d502fcf876556d04d7ae6d99e517880029";

const diceData = "0x608060405234801561001057600080fd5b506040516020806119ff8339810180604052810190808051906020019092919050505080600181905550506119b58061004a6000396000f300608060405260043610610078576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680633e03dc9d1461007d578063863d22c7146101c2578063add4c784146101ed578063b22524c11461025e578063ee4e16921461034f578063f29ada2f14610398575b600080fd5b34801561008957600080fd5b506101c06004803603810190808035600019169060200190929190803590602001909291908035906020019092919080359060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff1690602001909291908035600019169060200190929190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091929192908035600019169060200190929190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290803560001916906020019092919050505061047c565b005b3480156101ce57600080fd5b506101d7610a41565b6040518082815260200191505060405180910390f35b3480156101f957600080fd5b5061021c6004803603810190808035600019169060200190929190505050610a47565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561026a57600080fd5b5061034d6004803603810190808035600019169060200190929190803590602001909291908035906020019092919080359060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff1690602001909291908035600019169060200190929190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091929192908035600019169060200190929190505050610b69565b005b34801561035b57600080fd5b506103966004803603810190808035600019169060200190929190803590602001909291908035600019169060200190929190505050610fc1565b005b3480156103a457600080fd5b506103c760048036038101908080356000191690602001909291905050506114a4565b604051808973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001878152602001868152602001856000191660001916815260200184600019166000191681526020018360ff1660ff1681526020018281526020019850505050505050505060405180910390f35b600080600080846040516020018082600019166000191681526020019150506040516020818303038152906040526040518082805190602001908083835b6020831015156104df57805182526020820191506020810190506020830392506104ba565b6001836020036101000a038019825116818451168082178552505050505050905001915050604051809103902060001916896000191614151561058a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601c8152602001807f696e69746961746f72522073686f756c6420626520636f72726563740000000081525060200191505060405180910390fd5b61059a8f8f8f8f8f8f8f8f611539565b93508a73ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff16141515610665576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260278152602001807f7369676e61747572652073686f756c64206265207369676e656420627920696e81526020017f69746961746f720000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b308f8f8f8f8f8f8f8f8f604051602001808b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c010000000000000000000000000281526014018a600019166000191681526020018981526020018881526020018781526020018673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c010000000000000000000000000281526014018573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c01000000000000000000000000028152601401846000191660001916815260200183805190602001908083835b6020831015156107985780518252602082019150602081019050602083039250610773565b6001836020036101000a03801982511681845116808217855250505050505090500182600019166000191681526020019a50505050505050505050506040516020818303038152906040526040518082805190602001908083835b60208310151561081857805182526020820191506020810190506020830392506107f3565b6001836020036101000a038019825116818451168082178552505050505050905001915050604051809103902092508973ffffffffffffffffffffffffffffffffffffffff1661086884886116d2565b73ffffffffffffffffffffffffffffffffffffffff16141515610919576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260278152602001807f7369676e61747572652073686f756c64206265207369676e656420627920696e81526020017f69746961746f720000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b6109278d8d878a8f8f6117e8565b91506109338f8f6118ed565b90508160026000836000191660001916815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508973ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167f512c626a39638d8845d1244c69032b4456ac2ba22c1502165be19374ee93208183856040518083600019166000191681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019250505060405180910390a3505050505050505050505050505050565b60015481565b6000806000808460001916600019168152602001908152602001600020905060018160060160009054906101000a900460ff1660ff161415610b2557806007015443111515610b24576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260238152602001807f72657665616c2074696d652077696e646f772073686f756c6420626520636c6f81526020017f736564000000000000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b5b60026000846000191660001916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16915050919050565b60008060008673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515610c11576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601d8152602001807f74782073686f756c64206265206d616465206279206163636570746f7200000081525060200191505060405180910390fd5b610c218c8c8c8c8c8c8c8c611539565b92508773ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff16141515610cec576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260278152602001807f7369676e61747572652073686f756c64206265207369676e656420627920696e81526020017f69746961746f720000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b610cf68c8c6118ed565b9150600060026000846000191660001916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141515610de7576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602c8152602001807f73686f756c64206e6f7420736574746c6520616761696e207768656e20616c7281526020017f6561647920736574746c6564000000000000000000000000000000000000000081525060400191505060405180910390fd5b60008083600019166000191681526020019081526020016000209050898160020181905550888160030181905550878160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550868160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555085816004018160001916905550838160050181600019169055506001544301816007018190555060018160060160006101000a81548160ff021916908360ff1602179055508660026000846000191660001916815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508673ffffffffffffffffffffffffffffffffffffffff168873ffffffffffffffffffffffffffffffffffffffff167f77d6c2556176bfe2b3d17a9fcb85f4ffdb2a97fa933a92a471297cec936d75098484600701546040518083600019166000191681526020018281526020019250505060405180910390a3505050505050505050505050565b6000806000610fd086866118ed565b92506000808460001916600019168152602001908152602001600020915060018260060160009054906101000a900460ff1660ff161415156110a0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260228152602001807f73746174652073686f756c642062652077616974696e6720666f72207265766581526020017f616c00000000000000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b816004015460001916846040516020018082600019166000191681526020019150506040516020818303038152906040526040518082805190602001908083835b60208310151561110657805182526020820191506020810190506020830392506110e1565b6001836020036101000a0380198251168184511680821785525050505050509050019150506040518091039020600019161415156111ac576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601c8152602001807f696e69746961746f72522073686f756c6420626520636f72726563740000000081525060200191505060405180910390fd5b8160070154431115151561124e576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260218152602001807f72657665616c2074696d652077696e646f772073686f756c64206265206f706581526020017f6e0000000000000000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b6112b0826002015483600301548685600501548660000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168760010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166117e8565b90508060026000856000191660001916815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506000808460001916600019168152602001908152602001600020600080820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690556001820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff021916905560028201600090556003820160009055600482016000905560058201600090556006820160006101000a81549060ff0219169055600782016000905550508160010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168260000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f58bd3f2c86e089a272400331a7430bfada3c33073ac9cb0bd56079aad1297cee85846040518083600019166000191681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019250505060405180910390a3505050505050565b60006020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060020154908060030154908060040154908060050154908060060160009054906101000a900460ff16908060070154905088565b600080308a8a8a8a8a8a8a604051602001808973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c0100000000000000000000000002815260140188600019166000191681526020018781526020018681526020018581526020018473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c010000000000000000000000000281526014018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c010000000000000000000000000281526014018260001916600019168152602001985050505050505050506040516020818303038152906040526040518082805190602001908083835b60208310151561168a5780518252602082019150602081019050602083039250611665565b6001836020036101000a038019825116818451168082178552505050505050905001915050604051809103902090506116c381846116d2565b91505098975050505050505050565b600080600080604185511415156116e857600080fd5b6020850151925060408501519150606085015160001a9050601b8160ff16101561171357601b810190505b601b8160ff1614806117285750601c8160ff16145b151561173357600080fd5b600186828585604051600081526020016040526040518085600019166000191681526020018460ff1660ff1681526020018360001916600019168152602001826000191660001916815260200194505050505060206040516020810390808403906000865af11580156117aa573d6000803e3d6000fd5b50505060206040510351935060008473ffffffffffffffffffffffffffffffffffffffff16141515156117dc57600080fd5b83935050505092915050565b600080600086866040516020018083600019166000191681526020018260001916600019168152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310151561185a5780518252602082019150602081019050602083039250611835565b6001836020036101000a0380198251168184511680821785525050505050509050019150506040518091039020915087826001900481151561189857fe5b0690506028881115156118cc5760008964ffffffffff168260020a161415156118c3578492506118c7565b8392505b6118e1565b888110156118dc578492506118e0565b8392505b5b50509695505050505050565b60008282604051602001808360001916600019168152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b602083101515611954578051825260208201915060208101905060208303925061192f565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405180910390209050929150505600a165627a7a72305820e72787960a361d3e6d4a0ca24a85747a1dcd4396d8cfe3c7b4325fd4b83a350f0029"

const owner = "0xa08105d7650Fe007978a291CcFECbB321fC21ffe";
const ownerPrivateKey = new Buffer('6A22D7D5D87EFC4A1375203B7E54FBCF35FAA84975891C5E3D12BE86C579A6E5', 'hex');

async function main(diceRevealWindow, paymentWindowMin, paymentWindowMax) {

    var diceContract = await deploy(diceABI, diceData, [diceRevealWindow])

    if (diceContract != '0x0') {
        console.log("dice contract deployed: ", diceContract);
    } else {
        console.log("dice contract deployed failed");
        return;
    }

    var paymentContract = await deploy(paymentABI, paymentData, [diceContract, paymentWindowMin, paymentWindowMax]);

    if (paymentContract != '0x0') {
        console.log("payment contract deployed: ", paymentContract);
    } else {
        console.log("payment contract deployed failed");
        return;
    }

}

async function deploy(abi, data, args) {
    var myContract = new web3.eth.Contract(abi);
    data = myContract.deploy({data:data, arguments:args}).encodeABI();
    var nonce = await web3.eth.getTransactionCount(owner);

    var txData = {
        nonce: web3.utils.toHex(nonce),
        gasLimit: web3.utils.toHex(5000000),
        gasPrice: web3.utils.toHex(10e9), // 10 Gwei
        from: owner,
        data: data 
    }

    const transaction = new Tx(txData)
    transaction.sign(ownerPrivateKey)
    const serializedTx = transaction.serialize().toString('hex')
    let res = await web3.eth.sendSignedTransaction('0x' + serializedTx)

    if (res && res.status) {
        console.log("contract deployed: ", res);
        return res.contractAddress;
    } else {
        console.log("contract deployed failed");
        return "0x0";
    }
}

main(3, 3, 6);